<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dist√¢ncia de Correla√ß√£o Interativa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3833118765411251"
     crossorigin="anonymous"></script>
    <!-- Visualization & Content Choices: 
        - Defini√ß√£o, F√≥rmula, Propriedades, Aplica√ß√µes: Text blocks, lists (HTML/Tailwind) to inform. 
        - Visualizador: HTML text inputs for numerical vectors, JS for input parsing, statistical calculations (mean, std dev, covariance, Pearson correlation), Correlation Distance calculation, and dynamic canvas/text updates. Canvas displays a scatter plot of the paired data points and a line of best fit.
    -->
    <style>
      body {
        font-family: "Inter", sans-serif;
      }
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap");

      .content-section {
        display: block; margin-bottom: 2rem;
      }
      .canvas-container {
        position: relative;
        width: 100%;
        max-width: 500px;
        height: 300px; /* Adjusted for scatter plot */
        margin-left: auto;
        margin-right: auto;
        background-color: #f8fafc; /* slate-50 */
        border-radius: 0.5rem; /* rounded-lg */
        border: 1px solid #e2e8f0; /* slate-200 */
        box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.05);
      }
      #correlationCanvas {
        display: block;
        width: 100%;
        height: 100%;
      }
      @media (min-width: 640px) {
        /* sm breakpoint */
        .canvas-container {
          height: 350px;
        }
      }
      @media (min-width: 768px) {
        /* md breakpoint */
        .canvas-container {
          height: 400px;
        }
      }
      .formula {
        font-family: "Courier New", Courier, monospace;
        background-color: #f1f5f9; /* slate-100 */
        padding: 0.75rem; /* p-3 */
        border-radius: 0.25rem; /* rounded */
        font-size: 0.875rem; /* text-sm */
        color: #1e293b; /* slate-800 */
        overflow-x: auto; /* Allow horizontal scroll for long formulas */
        white-space: pre; /* Preserve whitespace and prevent wrapping */
      }
      .stats-grid {
        display: grid;
        grid-template-columns: auto 1fr;
        gap: 0.5rem 1rem;
        align-items: center;
      }
    </style>
  </head>
  <body class="bg-slate-100 text-slate-700 antialiased">
    <div class="bg-teal-600 text-white shadow-md">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
            <div class="flex items-center">
                <a href="index.html" class="text-xl font-bold hover:text-teal-200 transition-colors">P√°gina Inicial</a>
            </div>
          <div class="relative">
            <button
              id="metrics-menu-button"
              class="px-3 py-2 rounded-md text-sm font-medium hover:bg-teal-700 focus:outline-none focus:bg-teal-700 transition-colors"
            >
              M√©tricas de Dist√¢ncia <span class="ml-1">&#9662;</span>
            </button>
            <div
              id="metrics-dropdown"
              class="hidden origin-top-right absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none py-1 z-50"
            >
              <a
                href="chebyshevDistance.html"
                class="block px-4 py-2 text-sm text-slate-700 hover:bg-teal-50 hover:text-teal-600 transition-colors"
                >Dist. de Chebyshev</a
              >
              <a
                href="correlationDistance.html"
                class="block px-4 py-2 text-sm text-slate-700 hover:bg-teal-50 hover:text-teal-600 transition-colors"
                >Dist. de Correla√ß√£o</a
              >
              <a
                href="cosineDistance.html"
                class="block px-4 py-2 text-sm text-slate-700 hover:bg-teal-50 hover:text-teal-600 transition-colors"
                >Dist. Cosseno</a
              >
              <a
                href="diceDistance.html"
                class="block px-4 py-2 text-sm text-slate-700 hover:bg-teal-50 hover:text-teal-600 transition-colors"
                >Dist. Dice</a
              >
              <a
                href="euclidianDistance.html"
                class="block px-4 py-2 text-sm text-slate-700 hover:bg-teal-50 hover:text-teal-600 transition-colors"
                >Dist. Euclidiana</a
              >
              <a
                href="hammingDistance.html"
                class="block px-4 py-2 text-sm text-slate-700 hover:bg-teal-50 hover:text-teal-600 transition-colors"
                >Dist. de Hamming</a
              >
              <a
                href="hellingerDistance.html"
                class="block px-4 py-2 text-sm text-slate-700 hover:bg-teal-50 hover:text-teal-600 transition-colors"
                >Dist. de Hellinger</a
              >
              <a
                href="jaccardDistance.html"
                class="block px-4 py-2 text-sm text-slate-700 hover:bg-teal-50 hover:text-teal-600 transition-colors"
                >Dist. de Jaccard</a
              >
              <a
                href="mahalanobisDistance.html"
                class="block px-4 py-2 text-sm text-slate-700 hover:bg-teal-50 hover:text-teal-600 transition-colors"
                >Dist. de Mahalanobis</a
              >
              <a
                href="manhattanDistance.html"
                class="block px-4 py-2 text-sm text-slate-700 hover:bg-teal-50 hover:text-teal-600 transition-colors"
                >Dist. de Manhattan</a
              >
              <a
                href="minkowskiDistance.html"
                class="block px-4 py-2 text-sm text-slate-700 hover:bg-teal-50 hover:text-teal-600 transition-colors"
                >Dist. de Minkowski</a
              >
            </div>
          </div>
        </div>
    </div>
</div>
    <div class="container mx-auto p-4 sm:p-6 lg:p-8 max-w-5xl">
      <header class="text-center mb-8">
        <h1 class="text-4xl font-bold text-blue-600">
          üìà Dist√¢ncia de Correla√ß√£o Interativa üìâ
        </h1>
      </header>

      <main>
        <section
          id="definicao"
          class="content-section bg-white p-6 rounded-lg shadow-md"
        >
          <h2 class="text-2xl font-semibold text-blue-600 mb-4">
            O que √© a Dist√¢ncia de Correla√ß√£o?
          </h2>
          <p class="mb-3 leading-relaxed">
            Esta se√ß√£o introduz a Dist√¢ncia de Correla√ß√£o. Voc√™ aprender√° que
            ela √© uma medida de dissimilaridade entre dois vetores de dados
            num√©ricos, baseada em qu√£o fortemente eles est√£o linearmente
            relacionados.
          </p>
          <p class="mb-3 leading-relaxed">
            A <strong>Dist√¢ncia de Correla√ß√£o</strong> √© derivada do coeficiente
            de correla√ß√£o de Pearson (œÅ). Enquanto o coeficiente de Pearson mede
            a for√ßa e a dire√ß√£o de uma rela√ß√£o linear entre duas vari√°veis
            (variando de -1 para correla√ß√£o negativa perfeita, a +1 para
            correla√ß√£o positiva perfeita, com 0 indicando nenhuma correla√ß√£o
            linear), a Dist√¢ncia de Correla√ß√£o transforma essa medida em uma
            no√ß√£o de dissimilaridade.
          </p>
          <p class="mb-3 leading-relaxed">
            Comumente, a Dist√¢ncia de Correla√ß√£o (d) √© definida como
            <code class="text-xs bg-slate-200 p-1 rounded">d = 1 - œÅ</code>.
            Nesta formula√ß√£o:
          </p>
          <ul class="list-disc list-inside space-y-1 pl-4 mb-3">
            <li>
              Se œÅ = 1 (correla√ß√£o positiva perfeita), d = 0 (sem dist√¢ncia,
              m√°xima similaridade).
            </li>
            <li>Se œÅ = 0 (sem correla√ß√£o linear), d = 1.</li>
            <li>
              Se œÅ = -1 (correla√ß√£o negativa perfeita), d = 2 (m√°xima
              dist√¢ncia).
            </li>
          </ul>
          <p class="leading-relaxed">
            Ela √© √∫til para comparar s√©ries temporais, perfis de express√£o
            g√™nica, ou quaisquer conjuntos de dados onde a tend√™ncia de varia√ß√£o
            conjunta √© mais importante do que as magnitudes absolutas dos
            valores.
          </p>
        </section>

        <section
          id="formula"
          class="content-section bg-white p-6 rounded-lg shadow-md"
        >
          <h2 class="text-2xl font-semibold text-blue-600 mb-4">
            üí° F√≥rmula da Dist√¢ncia de Correla√ß√£o e Seus Termos
          </h2>
          <p class="mb-4 leading-relaxed">
            A Dist√¢ncia de Correla√ß√£o √© baseada no Coeficiente de Correla√ß√£o de
            Pearson (œÅ).
          </p>

          <div class="mb-6">
            <h3 class="text-xl font-medium text-slate-700 mb-2">
              Coeficiente de Correla√ß√£o de Pearson (œÅ)
            </h3>
            <p class="mb-2">
              Para dois vetores X = (x<sub>1</sub>, ..., x<sub>n</sub>) e Y =
              (y<sub>1</sub>, ..., y<sub>n</sub>) de tamanho n:
            </p>
            <div class="formula">
              œÅ(X,Y) = cov(X,Y) / (œÉ<sub>X</sub> * œÉ<sub>Y</sub>)
            </div>
            <p class="my-2">Onde:</p>
            <ul class="list-disc list-inside space-y-1 pl-4 mb-2 text-sm">
              <li><strong>cov(X,Y)</strong> √© a covari√¢ncia entre X e Y:</li>
            </ul>
            <div class="formula text-sm">
              cov(X,Y) = Œ£ [ (x·µ¢ - xÃÑ) * (y·µ¢ - »≥) ] / n
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (para popula√ß√£o)
              <br />
              cov(X,Y) = Œ£ [ (x·µ¢ - xÃÑ) * (y·µ¢ - »≥) ] / (n-1) &nbsp;&nbsp; (para
              amostra)
            </div>
            <p class="my-2 text-sm">
              Neste visualizador, usamos a defini√ß√£o de amostra para covari√¢ncia
              e desvio padr√£o, que √© comum em estat√≠stica aplicada.
            </p>
            <ul class="list-disc list-inside space-y-1 pl-4 mb-2 text-sm">
              <li>
                <strong>œÉ<sub>X</sub></strong> √© o desvio padr√£o de X:
              </li>
            </ul>
            <div class="formula text-sm">
              œÉ<sub>X</sub> = ‚àö [ Œ£ (x·µ¢ - xÃÑ)¬≤ / (n-1) ]
            </div>
            <ul class="list-disc list-inside space-y-1 pl-4 mb-2 text-sm">
              <li>
                <strong>œÉ<sub>Y</sub></strong> √© o desvio padr√£o de Y:
              </li>
            </ul>
            <div class="formula text-sm">
              œÉ<sub>Y</sub> = ‚àö [ Œ£ (y·µ¢ - »≥)¬≤ / (n-1) ]
            </div>
            <p class="my-2">
              Alternativamente, a f√≥rmula de œÅ pode ser escrita diretamente
              como:
            </p>
            <div class="formula">
              œÅ = Œ£((x·µ¢ - xÃÑ)(y·µ¢ - »≥)) / ( ‚àö[Œ£(x·µ¢ - xÃÑ)¬≤] * ‚àö[Œ£(y·µ¢ - »≥)¬≤] )
            </div>
          </div>

          <div class="mb-6">
            <h3 class="text-xl font-medium text-slate-700 mb-2">
              Dist√¢ncia de Correla√ß√£o (d)
            </h3>
            <p class="mb-2">A Dist√¢ncia de Correla√ß√£o √© ent√£o:</p>
            <div class="formula">d(X,Y) = 1 - œÅ(X,Y)</div>
          </div>

          <div>
            <h3 class="text-xl font-medium text-slate-700 mb-3">
              üìù Desvendando os Termos
            </h3>
            <ul class="list-disc list-inside space-y-2 pl-2 leading-relaxed">
              <li>
                <strong>X, Y:</strong> Os dois vetores de dados num√©ricos sendo
                comparados.
              </li>
              <li>
                <strong>x·µ¢, y·µ¢:</strong> O i-√©simo elemento dos vetores X e Y,
                respectivamente.
              </li>
              <li>
                <strong>xÃÑ (<code>meanX</code>), »≥ (<code>meanY</code>):</strong>
                As m√©dias aritm√©ticas dos elementos em X e Y.
              </li>
              <li>
                <strong>œÉ<sub>X</sub>, œÉ<sub>Y</sub>:</strong> Os desvios padr√£o
                de X e Y, medindo a dispers√£o dos dados em torno de suas m√©dias.
              </li>
              <li>
                <strong>cov(X,Y):</strong> A covari√¢ncia entre X e Y, medindo
                como as duas vari√°veis mudam juntas.
              </li>
              <li><strong>Œ£:</strong> S√≠mbolo de somat√≥rio.</li>
              <li>
                <strong>n:</strong> O n√∫mero de elementos em cada vetor (os
                vetores devem ter o mesmo comprimento).
              </li>
            </ul>
            <p class="mt-3 text-sm text-slate-500">
              Nota: Para que a correla√ß√£o seja calcul√°vel e significativa, n
              deve ser pelo menos 2, e os desvios padr√£o de X e Y devem ser
              diferentes de zero.
            </p>
          </div>
        </section>

        <section
          id="propriedades"
          class="content-section bg-white p-6 rounded-lg shadow-md"
        >
          <h2 class="text-2xl font-semibold text-blue-600 mb-4">
            üîë Propriedades Fundamentais
          </h2>
          <p class="mb-6 leading-relaxed">
            A Dist√¢ncia de Correla√ß√£o (definida como
            <code class="text-xs bg-slate-200 p-1 rounded">1 - œÅ</code>) possui
            as seguintes propriedades como uma medida de dissimilaridade:
          </p>
          <ul class="space-y-4">
            <li class="p-4 bg-slate-50 rounded-md shadow-sm">
              <h3 class="font-semibold text-slate-700">1. Intervalo (Range)</h3>
              <p class="text-sm">
                A dist√¢ncia varia de 0 a 2:
                <code class="text-xs bg-slate-200 p-1 rounded"
                  >0 ‚â§ d(X,Y) ‚â§ 2</code
                >. Um valor de 0 significa correla√ß√£o positiva perfeita (œÅ=1), 1
                significa aus√™ncia de correla√ß√£o linear (œÅ=0), e 2 significa
                correla√ß√£o negativa perfeita (œÅ=-1).
              </p>
            </li>
            <li class="p-4 bg-slate-50 rounded-md shadow-sm">
              <h3 class="font-semibold text-slate-700">2. N√£o-negatividade</h3>
              <p class="text-sm">
                A dist√¢ncia √© sempre maior ou igual a zero:
                <code class="text-xs bg-slate-200 p-1 rounded">d(X,Y) ‚â• 0</code
                >.
              </p>
            </li>
            <li class="p-4 bg-slate-50 rounded-md shadow-sm">
              <h3 class="font-semibold text-slate-700">3. Identidade</h3>
              <p class="text-sm">
                Se
                <code class="text-xs bg-slate-200 p-1 rounded">d(X,Y) = 0</code
                >, ent√£o
                <code class="text-xs bg-slate-200 p-1 rounded">œÅ(X,Y) = 1</code
                >, o que significa que X e Y s√£o perfeitamente correlacionados
                positivamente (Y = aX + b com a > 0). Se X = Y, ent√£o d(X,X) =
                0.
              </p>
            </li>
            <li class="p-4 bg-slate-50 rounded-md shadow-sm">
              <h3 class="font-semibold text-slate-700">4. Simetria</h3>
              <p class="text-sm">
                A dist√¢ncia de X a Y √© a mesma que a dist√¢ncia de Y a X:
                <code class="text-xs bg-slate-200 p-1 rounded"
                  >d(X,Y) = d(Y,X)</code
                >
                porque
                <code class="text-xs bg-slate-200 p-1 rounded"
                  >œÅ(X,Y) = œÅ(Y,X)</code
                >.
              </p>
            </li>
            <li class="p-4 bg-slate-50 rounded-md shadow-sm">
              <h3 class="font-semibold text-slate-700">
                5. Desigualdade Triangular
              </h3>
              <p class="text-sm">
                A Dist√¢ncia de Correla√ß√£o
                <code class="text-xs bg-slate-200 p-1 rounded">1 - œÅ</code> n√£o
                satisfaz necessariamente a desigualdade triangular e, portanto,
                n√£o √© uma m√©trica estrita em todos os casos. No entanto,
                transforma√ß√µes como a dist√¢ncia angular (<code
                  class="text-xs bg-slate-200 p-1 rounded"
                  >‚àö(2(1-œÅ))</code
                >
                ou
                <code class="text-xs bg-slate-200 p-1 rounded">acos(œÅ)</code>)
                podem ser m√©tricas. Apesar disso,
                <code class="text-xs bg-slate-200 p-1 rounded">1 - œÅ</code> √©
                amplamente utilizada como uma medida de dissimilaridade eficaz.
              </p>
            </li>
          </ul>
        </section>

        <section
          id="aplicacoes"
          class="content-section bg-white p-6 rounded-lg shadow-md"
        >
          <h2 class="text-2xl font-semibold text-blue-600 mb-4">
            üéØ Principais Aplica√ß√µes Pr√°ticas
          </h2>
          <p class="mb-6 leading-relaxed">
            A Dist√¢ncia de Correla√ß√£o √© valiosa em campos onde a rela√ß√£o de
            tend√™ncia entre vari√°veis √© crucial.
          </p>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="bg-slate-50 p-4 rounded-lg shadow">
              <h3 class="text-lg font-semibold text-slate-700 mb-2">
                üß¨ Bioinform√°tica e Gen√¥mica
              </h3>
              <p class="text-sm leading-relaxed">
                Para agrupar genes com padr√µes de express√£o semelhantes em
                diferentes condi√ß√µes ou amostras (an√°lise de co-express√£o).
              </p>
            </div>
            <div class="bg-slate-50 p-4 rounded-lg shadow">
              <h3 class="text-lg font-semibold text-slate-700 mb-2">
                üíπ An√°lise Financeira
              </h3>
              <p class="text-sm leading-relaxed">
                Para medir a dissimilaridade no movimento de pre√ßos de
                diferentes ativos financeiros, auxiliando na diversifica√ß√£o de
                portf√≥lios e an√°lise de risco.
              </p>
            </div>
            <div class="bg-slate-50 p-4 rounded-lg shadow">
              <h3 class="text-lg font-semibold text-slate-700 mb-2">
                üìä Minera√ß√£o de Dados e Aprendizado de M√°quina
              </h3>
              <p class="text-sm leading-relaxed">
                Em algoritmos de agrupamento (clustering) e classifica√ß√£o para
                s√©ries temporais ou outros dados vetoriais onde o padr√£o de
                varia√ß√£o √© importante. Sele√ß√£o de caracter√≠sticas.
              </p>
            </div>
            <div class="bg-slate-50 p-4 rounded-lg shadow">
              <h3 class="text-lg font-semibold text-slate-700 mb-2">
                üõí Sistemas de Recomenda√ß√£o
              </h3>
              <p class="text-sm leading-relaxed">
                Para encontrar usu√°rios ou itens com padr√µes de avalia√ß√£o
                semelhantes, mesmo que as classifica√ß√µes absolutas sejam
                diferentes.
              </p>
            </div>
            <div class="bg-slate-50 p-4 rounded-lg shadow">
              <h3 class="text-lg font-semibold text-slate-700 mb-2">
                üß† Neuroci√™ncia
              </h3>
              <p class="text-sm leading-relaxed">
                Para analisar a conectividade funcional entre diferentes regi√µes
                do c√©rebro com base na correla√ß√£o de suas atividades ao longo do
                tempo.
              </p>
            </div>
            <div class="bg-slate-50 p-4 rounded-lg shadow">
              <h3 class="text-lg font-semibold text-slate-700 mb-2">
                üó£Ô∏è Processamento de Sinais
              </h3>
              <p class="text-sm leading-relaxed">
                Para comparar a semelhan√ßa entre diferentes sinais ou formas de
                onda.
              </p>
            </div>
          </div>
        </section>

        <section
          id="visualizador"
          class="content-section bg-white p-6 rounded-lg shadow-md"
        >
          <h2 class="text-2xl font-semibold text-blue-600 mb-4">
            üî¨ Visualizador Interativo da Dist√¢ncia de Correla√ß√£o
          </h2>
          <p class="mb-6 leading-relaxed">
            Experimente a Dist√¢ncia de Correla√ß√£o! Insira dois vetores de dados
            num√©ricos (mesmo comprimento, m√≠nimo 2 pontos, separados por
            v√≠rgula). O gr√°fico de dispers√£o mostrar√° os pontos (x·µ¢, y·µ¢) e uma
            linha de tend√™ncia. As estat√≠sticas e a dist√¢ncia calculada ser√£o
            exibidas.
          </p>

          <div class="grid grid-cols-1 md:grid-cols-3 gap-6 items-start">
            <div class="md:col-span-1 space-y-6">
              <div>
                <h3 class="text-lg font-medium text-slate-700 mb-1">Vetor X</h3>
                <p class="text-xs text-slate-500 mb-2">
                  N√∫meros separados por v√≠rgula (ex: <code>1,2,3,4,5</code>)
                </p>
                <input
                  type="text"
                  id="vectorXInput"
                  value="1, 2, 3, 4, 5"
                  class="w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"
                />
              </div>
              <div>
                <h3 class="text-lg font-medium text-slate-700 mb-1">Vetor Y</h3>
                <p class="text-xs text-slate-500 mb-2">
                  N√∫meros separados por v√≠rgula (ex: <code>2,4,5,4,6</code>)
                </p>
                <input
                  type="text"
                  id="vectorYInput"
                  value="2, 4, 5, 4, 6"
                  class="w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"
                />
              </div>
              <div id="statsResults" class="mt-6 space-y-3 text-sm stats-grid">
                <p class="font-semibold">M√©dia X (xÃÑ):</p>
                <span id="meanXResult">N/A</span>
                <p class="font-semibold">M√©dia Y (»≥):</p>
                <span id="meanYResult">N/A</span>
                <p class="font-semibold">Desvio Padr√£o X (œÉ<sub>X</sub>):</p>
                <span id="stdDevXResult">N/A</span>
                <p class="font-semibold">Desvio Padr√£o Y (œÉ<sub>Y</sub>):</p>
                <span id="stdDevYResult">N/A</span>
                <p class="font-semibold">Covari√¢ncia(X,Y):</p>
                <span id="covarianceResult">N/A</span>
                <p class="font-semibold">Coef. Correla√ß√£o (œÅ):</p>
                <span id="pearsonResult" class="font-bold">N/A</span>
                <p class="text-lg font-medium mt-2">Dist√¢ncia de Correla√ß√£o:</p>
                <p
                  id="correlationDistanceResult"
                  class="font-bold text-blue-600 text-2xl"
                >
                  N/A
                </p>
              </div>
              <p id="errorMessage" class="text-red-500 text-sm mt-2"></p>
            </div>

            <div class="md:col-span-2">
              <div class="canvas-container">
                <canvas id="correlationCanvas"></canvas>
              </div>
              <p class="text-xs text-center mt-2 text-slate-500">
                Gr√°fico de dispers√£o dos pontos (X·µ¢, Y·µ¢) com linha de melhor
                ajuste.
              </p>
            </div>
          </div>
        </section>
      </main>

      <footer class="text-center mt-12 py-6 border-t border-slate-300">
        <p class="text-sm text-slate-500">
          &copy; <span id="currentYearCorrelation"></span> Aplica√ß√£o Interativa
          da Dist√¢ncia de Correla√ß√£o. Desenvolvido para fins educacionais.
        </p>
      </footer>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        document.getElementById("currentYearCorrelation").textContent =
          new Date().getFullYear();

        const vectorXInputEl = document.getElementById("vectorXInput");
        const vectorYInputEl = document.getElementById("vectorYInput");

        const meanXResultEl = document.getElementById("meanXResult");
        const meanYResultEl = document.getElementById("meanYResult");
        const stdDevXResultEl = document.getElementById("stdDevXResult");
        const stdDevYResultEl = document.getElementById("stdDevYResult");
        const covarianceResultEl = document.getElementById("covarianceResult");
        const pearsonResultEl = document.getElementById("pearsonResult");
        const correlationDistanceResultEl = document.getElementById(
          "correlationDistanceResult"
        );
        const errorMessageEl = document.getElementById("errorMessage");

        const canvas = document.getElementById("correlationCanvas");
        const ctx = canvas.getContext("2d");

        function parseVectorInput(inputValue) {
          return inputValue
            .split(",")
            .map((item) => parseFloat(item.trim()))
            .filter((num) => !isNaN(num));
        }

        function calculateMean(arr) {
          if (arr.length === 0) return 0;
          return arr.reduce((sum, val) => sum + val, 0) / arr.length;
        }

        function calculateStdDev(arr, mean) {
          if (arr.length < 2) return 0;
          const variance =
            arr.reduce((sum, val) => sum + Math.pow(val - mean, 2), 0) /
            (arr.length - 1);
          return Math.sqrt(variance);
        }

        function calculateCovariance(arrX, arrY, meanX, meanY) {
          if (arrX.length < 2) return 0;
          let sum = 0;
          for (let i = 0; i < arrX.length; i++) {
            sum += (arrX[i] - meanX) * (arrY[i] - meanY);
          }
          return sum / (arrX.length - 1);
        }

        function calculatePearsonCorrelation(
          arrX,
          arrY,
          meanX,
          meanY,
          stdDevX,
          stdDevY
        ) {
          if (stdDevX === 0 || stdDevY === 0) {
            return NaN;
          }
          const covariance = calculateCovariance(arrX, arrY, meanX, meanY);
          return covariance / (stdDevX * stdDevY);
        }

        function calculateAndDisplay() {
          errorMessageEl.textContent = "";
          const vectorX = parseVectorInput(vectorXInputEl.value);
          const vectorY = parseVectorInput(vectorYInputEl.value);

          if (vectorX.length !== vectorY.length) {
            errorMessageEl.textContent =
              "Os vetores X e Y devem ter o mesmo comprimento.";
            clearResults();
            drawScatterPlot([], [], NaN, NaN, NaN, NaN, NaN);
            return;
          }
          if (vectorX.length < 2) {
            errorMessageEl.textContent =
              "S√£o necess√°rios pelo menos 2 pontos de dados para calcular a correla√ß√£o.";
            clearResults();
            drawScatterPlot([], [], NaN, NaN, NaN, NaN, NaN);
            return;
          }

          const meanX = calculateMean(vectorX);
          const meanY = calculateMean(vectorY);
          const stdDevX = calculateStdDev(vectorX, meanX);
          const stdDevY = calculateStdDev(vectorY, meanY);

          const covariance = calculateCovariance(
            vectorX,
            vectorY,
            meanX,
            meanY
          );

          const pearsonCorrelation = calculatePearsonCorrelation(
            vectorX,
            vectorY,
            meanX,
            meanY,
            stdDevX,
            stdDevY
          );

          meanXResultEl.textContent = meanX.toFixed(4);
          meanYResultEl.textContent = meanY.toFixed(4);
          stdDevXResultEl.textContent = stdDevX.toFixed(4);
          stdDevYResultEl.textContent = stdDevY.toFixed(4);
          covarianceResultEl.textContent = covariance.toFixed(4);

          if (isNaN(pearsonCorrelation)) {
            pearsonResultEl.textContent = "Indefinido";
            pearsonResultEl.classList.remove("text-green-600", "text-red-600");
            pearsonResultEl.classList.add("text-orange-500");
            correlationDistanceResultEl.textContent = "Indefinido";
            errorMessageEl.textContent =
              "Correla√ß√£o indefinida (verifique se h√° varia√ß√£o nos dados).";
            drawScatterPlot(
              vectorX,
              vectorY,
              meanX,
              meanY,
              stdDevX,
              stdDevY,
              NaN
            );
          } else {
            pearsonResultEl.textContent = pearsonCorrelation.toFixed(4);
            if (pearsonCorrelation > 0) {
              pearsonResultEl.classList.remove(
                "text-red-600",
                "text-orange-500"
              );
              pearsonResultEl.classList.add("text-green-600");
            } else if (pearsonCorrelation < 0) {
              pearsonResultEl.classList.remove(
                "text-green-600",
                "text-orange-500"
              );
              pearsonResultEl.classList.add("text-red-600");
            } else {
              pearsonResultEl.classList.remove(
                "text-green-600",
                "text-red-600",
                "text-orange-500"
              );
            }

            const correlationDistance = 1 - pearsonCorrelation;
            correlationDistanceResultEl.textContent =
              correlationDistance.toFixed(4);
            drawScatterPlot(
              vectorX,
              vectorY,
              meanX,
              meanY,
              stdDevX,
              stdDevY,
              pearsonCorrelation
            );
          }
        }

        function clearResults() {
          meanXResultEl.textContent = "N/A";
          meanYResultEl.textContent = "N/A";
          stdDevXResultEl.textContent = "N/A";
          stdDevYResultEl.textContent = "N/A";
          covarianceResultEl.textContent = "N/A";
          pearsonResultEl.textContent = "N/A";
          pearsonResultEl.classList.remove(
            "text-green-600",
            "text-red-600",
            "text-orange-500"
          );
          correlationDistanceResultEl.textContent = "N/A";
        }

        function drawScatterPlot(
          arrX,
          arrY,
          meanX,
          meanY,
          stdDevX,
          stdDevY,
          correlation
        ) {
          const width = canvas.width;
          const height = canvas.height;
          ctx.clearRect(0, 0, width, height);

          if (arrX.length === 0) return;

          const padding = 40;
          const minXData = Math.min(...arrX);
          const maxXData = Math.max(...arrX);
          const minYData = Math.min(...arrY);
          const maxYData = Math.max(...arrY);

          let dataWidth = maxXData - minXData;
          let dataHeight = maxYData - minYData;

          if (dataWidth === 0)
            dataWidth = minXData === 0 ? 10 : Math.abs(minXData) * 0.5 || 10;
          if (dataHeight === 0)
            dataHeight = minYData === 0 ? 10 : Math.abs(minYData) * 0.5 || 10;

          const effectiveMinX = minXData - dataWidth * 0.1;
          const effectiveMaxX = maxXData + dataWidth * 0.1;
          const effectiveMinY = minYData - dataHeight * 0.1;
          const effectiveMaxY = maxYData + dataHeight * 0.1;

          dataWidth = effectiveMaxX - effectiveMinX;
          dataHeight = effectiveMaxY - effectiveMinY;

          const scaleX = (width - 2 * padding) / dataWidth;
          const scaleY = (height - 2 * padding) / dataHeight;

          const toCanvasX = (dataVal) =>
            padding + (dataVal - effectiveMinX) * scaleX;
          const toCanvasY = (dataVal) =>
            height - (padding + (dataVal - effectiveMinY) * scaleY);

          ctx.beginPath();
          ctx.strokeStyle = "#cbd5e1";
          ctx.lineWidth = 1;
          ctx.moveTo(padding, toCanvasY(effectiveMinY));
          ctx.lineTo(width - padding, toCanvasY(effectiveMinY));
          ctx.moveTo(toCanvasX(effectiveMinX), padding);
          ctx.lineTo(toCanvasX(effectiveMinX), height - padding);
          ctx.stroke();

          if (effectiveMinX <= 0 && effectiveMaxX >= 0) {
            ctx.beginPath();
            ctx.strokeStyle = "#a0aec0";
            ctx.moveTo(toCanvasX(0), padding);
            ctx.lineTo(toCanvasX(0), height - padding);
            ctx.stroke();
          }
          if (effectiveMinY <= 0 && effectiveMaxY >= 0) {
            ctx.beginPath();
            ctx.strokeStyle = "#a0aec0";
            ctx.moveTo(padding, toCanvasY(0));
            ctx.lineTo(width - padding, toCanvasY(0));
            ctx.stroke();
          }

          ctx.fillStyle = "#3b82f6";
          for (let i = 0; i < arrX.length; i++) {
            ctx.beginPath();
            ctx.arc(toCanvasX(arrX[i]), toCanvasY(arrY[i]), 4, 0, 2 * Math.PI);
            ctx.fill();
          }

          if (!isNaN(correlation) && stdDevX > 0) {
            const slope = correlation * (stdDevY / stdDevX);
            const intercept = meanY - slope * meanX;

            ctx.beginPath();
            ctx.strokeStyle = "#ef4444";
            ctx.lineWidth = 2;

            let lineStartX = effectiveMinX;
            let lineStartY = slope * lineStartX + intercept;
            let lineEndX = effectiveMaxX;
            let lineEndY = slope * lineEndX + intercept;

            ctx.moveTo(toCanvasX(lineStartX), toCanvasY(lineStartY));
            ctx.lineTo(toCanvasX(lineEndX), toCanvasY(lineEndY));
            ctx.stroke();
          } else if (!isNaN(correlation) && stdDevX === 0 && stdDevY > 0) {
            ctx.beginPath();
            ctx.strokeStyle = "#ef4444";
            ctx.lineWidth = 2;
            ctx.moveTo(toCanvasX(meanX), toCanvasY(effectiveMinY));
            ctx.lineTo(toCanvasX(meanX), toCanvasY(effectiveMaxY));
            ctx.stroke();
          } else if (!isNaN(correlation) && stdDevY === 0 && stdDevX > 0) {
            ctx.beginPath();
            ctx.strokeStyle = "#ef4444";
            ctx.lineWidth = 2;
            ctx.moveTo(toCanvasX(effectiveMinX), toCanvasY(meanY));
            ctx.lineTo(toCanvasX(effectiveMaxX), toCanvasY(meanY));
            ctx.stroke();
          }
        }

        [vectorXInputEl, vectorYInputEl].forEach((input) => {
          input.addEventListener("input", calculateAndDisplay);
        });

        function setupCanvas() {
          const style = getComputedStyle(canvas.parentElement);
          canvas.width = parseInt(style.width) || 300;
          canvas.height = parseInt(style.height) || 300;
          calculateAndDisplay();
        }

        if (typeof ResizeObserver !== "undefined") {
          new ResizeObserver(() => {
            setupCanvas();
          }).observe(canvas.parentElement);
        } else {
          window.addEventListener("resize", setupCanvas);
        }

        setupCanvas();
      });
    </script>
<script>
// Simple script for dropdown toggle
const metricsMenuButton = document.getElementById('metrics-menu-button');
const metricsDropdown = document.getElementById('metrics-dropdown');
if (metricsMenuButton && metricsDropdown) {
    metricsMenuButton.addEventListener('click', () => {
        metricsDropdown.classList.toggle('hidden');
    });
    // Optional: Close dropdown if clicked outside
    document.addEventListener('click', (event) => {
        if (!metricsMenuButton.contains(event.target) && !metricsDropdown.contains(event.target)) {
            metricsDropdown.classList.add('hidden');
        }
    });
}
</script>
  </body>
</html>
